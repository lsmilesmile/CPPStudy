# 复合类型

## 4.1 数组

一种数据格式，存储多个同类型的值。数组声明要指出：

- 存储在每个元素中的值的类型；
- 数组名；
- 数组中的元素数。

例如：

```c++
short months[12]; // typeName arrayName[arraySize]
```

arraySize指定元素数目，可以是：

- 整型常量，如10；
- const值；
- 常量表达式，如8*sizeof(int)

### 4.1.2 数组的初始化规则

**只有在定义数组的时候才能初始化，以后就不能使用了。也不能将一个数组赋值给另一个数组。**

数组初始化：

```c++
int cards[4] = {1, 2, 3, 4};
int hand[4];
```

初始化数组时，值可以少于数组元素数目。如：

```c++
float hotelTips[5] = {2.1, 2.2}; // 只对前两个元素初始化，其他设置为0
long totals[500] = {0}; // 都初始化为0
```

如果初始化时，[]中为空，也就是没指定元素数目，则编译器将自动计算元素个数，如：

```c++
short things[] = {1, 2, 3, 4};
```

### 4.1.3 C++11初始化数组的方法

C++11将使用大括号初始化（初始化列表）作为一种通用的初始化方式，可用于所有类型。

```c++
double earnings[4] {1.2e3, 1.7e4, 2.3e6, 1.1e3}; // 省略=
unsigned int coouts[10] = {}; // 将所有元素设置为0
```

**注意：列表初始化禁止缩窄转换。**



## 4.2字符串

字符串是存储在内存中的连续字节中的一系列字符。C++处理字符串的两种方式：

- C-style string
- string类库

存储在连续字节中的一系列字符意味着可以将字符串存储在char数组中。C-风格字符串有一种特殊的性质：以空字符\\0结尾。

```c++
char dog[5] = {'h', 'e', 'l', 'l', '0'}; // not a string
char x[5] = {'c', 'e', 'l', 'l', '\0'}; // a string
```

一种更方便的将字符数组初始化为字符串的方式：用一个引号括起字符串，这种字符串被称为字符串常量。

```c++
char bird[6] = "hello"; // 空字符\0被自动添加，但是要确保数组能存储字符串中所有的字符，包括空字符
char fish[] = "hello";  // 让编译器自动计算数组长度
```



### 4.2.2 在数组中使用字符串

```c++
/*
 * @Description: 
 * @Author: liuxiao
 * @Date: 
 */

#include <iostream>
#include <cstring>

int main() {
	const int Size = 15;
	char name1[Size];
	char name2[Size] = "C++owboy";

	std::cout << name2 << "\n";
	std::cin >> name1;
	std::cout << name1 << ", " << strlen(name1) << "\n";
	std::cout << sizeof(name1);
	std::cout << name1[0] << "\n";
	system("pause");
	return 0;
}
```

- **sizeof**运算符可以指出整个数组的长度；
- **strlen()**函数返回存储在数组中的字符串的长度，而不是数组本身的长度；
- **strlen()**只计算可见的字符，不把空字符计算在内；即如果要存储“smile”，则数组长度至少是strlen(smile) + 1。



### 4.2.3 字符串输入

```c++
#include <iostream>
#include <cstring>

int main() {
	const int ArSize = 20;
	char name[ArSize];
	char dessert[ArSize];

	std::cout << "Enter your name: \n";
	std::cin >> name;
	std::cout << "Enter your favorite dessert: \n";
	std::cin >> dessert;
	std::cout << dessert << ", " << name << "\n";
	system("pause");
	return 0;
}
```

**Enter your name:**
**liu xiao**
**Enter your favorite dessert:**
**xiao, liu**
**请按任意键继续. . .**

该例子还没等我输入dessert就将结果打印，原因：cin使用空白（空格、制表符和换行符）来确定字符串的结束位置，所以cin在获取字符数组输入时只读取了一个单词liu。cin读到空字符后认为输入给数组的字符已经全部输入完毕，将liu放到数组中，并自动在结尾添加空字符。接着程序往下执行，cin要找到用户输入的dessert，这时它发现xiao，因此cin读取xiao，并将它放到dessert数组中。

### 4.2.4 面向行读取字符串

1. **getline()**

   istream中

   getline()读取整行，通过回车键输入的换行符来确定输入结尾。它丢弃换行符。

   getline(ArName, length)，ArName:存储输入 行的数组的名称，length:字符数（包括空字符）。

   例如：将名字读入到一个包含20个元素的name数组中:

   ```c++
   cin.getline(name, 20);
   ```

   

2. **get()**

   istream中

   该函数一种变体的工作方式和getline()类似，接受的参数相同，解释参数的方式也相同，并且都读到行尾。但get不 丢弃换行符，将换行符留在输入队列中。如：

   ```c++
   cin.get(name, ArSize);
   cin.get(dessert, ArSize);
   ```

   第一调用后，比如输入：smile回车，这时候get找到回车符认为已经结束，于是将smile存储在name数组中，但是换行符还在输入队列中，因此，第二次调用时，get()，再从输入队列找输入的字符串时，便首先看到换行符，这时候get()认为已经到达结尾，但是第二次并没有读取到任何内容。于是get()的第二种变体是**get()**，不带任何参数。调用一下便可读取下一个字符，包括换行符，因此可以用来处理换行符：

   ```c++
   cin.get(name, ArSize);
   cin.get();
   cin.get(dessert, ArSize);
   ```



## 4.3 string类

头文件string。位于std名称空间中。

使用方式：

- **可以用C-风格字符串来初始化string对象。**
- **可以用cin来将键盘输入存储到string中。**
- **可以用cout来显示string。**
- **可以使用数组表示法来访问存储在string对象中的字符。**



### 4.3.1 C++11 字符串初始化

列表初始化：

```c++
char first_date[] = {"liu xiao"};
string second_date = {"ddddddddddd"};
```

### 4.3.2 赋值、拼接和附加

不能将一个数组赋值给另一个数组，可以将一个string赋值给另一个string。

```c++
string str1;
string str2 = "weew";
str1 = str2;
```

合并+

```c++
string str1;
string str2 = "ss";
string str3 = "tt";
str1 = str2 + str3;
```

### 4.3.3 string类其他操作

C-style处理字符串：

- **strcpy(dst, source)**

  ```c++
  #include <iostream>
  #include <cstring>
  
  int main() {
  	const int ArSize = 20;
  	char name[ArSize];
  	char dessert[ArSize];
  
  	std::cout << "Enter your name: \n";
  	std::cin >> name;
  	strcpy(dessert, name);
  	std::cout << dessert << "\n";
  	system("pause");
  	return 0;
  }
  ```

  **Enter your name:**
  **smileliu**
  **smileliu**
  **请按任意键继续. . .**

  

- **strcat(dst, source)**

  ```c++
  #include <iostream>
  #include <cstring>
  
  int main() {
  	const int ArSize = 20;
  	char name[ArSize];
  	char dessert[ArSize];
  
  	std::cout << "Enter your name: \n";
  	std::cin >> name;
  	std::cout << "Enter dessert: \n";
  	std::cin >> dessert;
  	strcat(dessert, name);
  	std::cout << dessert;
  	system("pause");
  	return 0;
  }
  ```

  **Enter your name:**
  **sssss**
  **Enter dessert:**
  **ttttt**
  **tttttsssss请按任意键继续. . .**

- **strlen(source)**

  ```c++
  /*
   * @Description: 
   * @Author: liuxiao
   * @Date: 
   */
  
  #include <iostream>
  #include <cstring>
  
  int main() {
  	const int ArSize = 20;
  	char name[ArSize];
  	char dessert[ArSize];
  
  	std::cout << "Enter your name: \n";
  	std::cin >> name;
  	strcpy(dessert, name);
  	std::cout << dessert << "\n";
  	int len = strlen(dessert);
  	std::cout << len << "\n";
  	system("pause");
  	return 0;
  }
  ```

  **Enter your name:**
  **smileliu**
  **smileliu**
  **8**
  **请按任意键继续. . .**



### 4.3.5 其他形式的字符串字面值

C++11有类型：wchar16_t，char32_t。

```c++
wchar_t title[] = L"fjaldjfa faldfjal"; // w_char string
char16_t name[] = u"Feladfa rpdf";
char32_t car[] = U"fdafa dfadfa";
```

C++11新增：原始（raw）字符串。

```c++
#include <iostream>
#include <cstring>

int main() {
	std::cout << R"(Liu " xiao \n.)" << "\n";
	system("pause");
	return 0;
}
```

**Liu " xiao \n.**
**请按任意键继续. . .**

### 